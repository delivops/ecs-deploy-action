# Example: Using Custom OTEL Collector Image with File-based Config
# This example shows how to use a custom OTEL collector image
# with file-based configuration and custom metrics port

name: app-with-custom-otel
replica_count: 2
cpu: 512
memory: 1024
cpu_arch: X86_64
role_arn: arn:aws:iam::123456789012:role/ecsTaskExecutionRole

# Basic environment variables
envs:
  - NODE_ENV: production
  - API_VERSION: v1

# Main application port
port: 8080

# OpenTelemetry collector using custom image
otel_collector:
  image_name: "amazon/config"     # Custom OTEL collector image (private ECR)
  extra_config: "config.yaml"    # Config file located at /conf/config.yaml in container
  metrics_port: 5000             # Custom metrics port (becomes CUSTOM_PORT env var)

# How this works:
# 1. Uses custom image from ECR: "{registry}/amazon/config" (private image)
# 2. Configuration is loaded from file: /conf/config.yaml inside the container
# 3. Command used: --config /conf/config.yaml
# 4. Environment variables added to OTEL container:
#    - SERVICE_NAME: "app-with-custom-otel" (app name)
#    - CUSTOM_PORT: "5000" (metrics port)
# 5. No SSM configuration is used (file-based config instead)

# Prerequisites:
# - The custom image "amazon/config" should exist in your ECR registry
# - The image should have the config file at /conf/config.yaml
# - ECR authentication is handled automatically by the action
