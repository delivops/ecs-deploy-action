# Example: Using New secrets_envs Format
# This example shows the new way to define secrets using the secrets_envs format
# which allows grouping multiple environment variables from the same secret

# Note: 'name' field is no longer required - service name comes from the action
replica_count: 2
cpu: 512
memory: 1024
cpu_arch: X86_64
role_arn: arn:aws:iam::123456789012:role/ecsTaskExecutionRole

# Basic environment variables
envs:
  - NODE_ENV: production
  - API_VERSION: 1
  - TIMEOUT: 30

# Main application port
port: 8080

# New secrets format - groups multiple environment variables by secret ID
secrets_envs:
  - id: arn:aws:secretsmanager:us-east-1:123456789012:secret:database-credentials-abc123
    values:
      - DB_USERNAME
      - DB_PASSWORD
      - DB_HOST
  - id: arn:aws:secretsmanager:us-east-1:123456789012:secret:api-keys-def456
    values:
      - EXTERNAL_API_KEY
      - WEBHOOK_SECRET
  - id: arn:aws:secretsmanager:us-east-1:123456789012:secret:certificates-ghi789
    values:
      - SSL_CERT
      - SSL_KEY

# How this works:
# 1. Each secret ID can provide multiple environment variables
# 2. Reduces duplication when multiple env vars come from same secret
# 3. Results in the same ECS task definition format as the old method
# 4. Environment variables created:
#    - DB_USERNAME from database-credentials-abc123:DB_USERNAME::
#    - DB_PASSWORD from database-credentials-abc123:DB_PASSWORD::
#    - DB_HOST from database-credentials-abc123:DB_HOST::
#    - EXTERNAL_API_KEY from api-keys-def456:EXTERNAL_API_KEY::
#    - WEBHOOK_SECRET from api-keys-def456:WEBHOOK_SECRET::
#    - SSL_CERT from certificates-ghi789:SSL_CERT::
#    - SSL_KEY from certificates-ghi789:SSL_KEY::

# Comparison with old format:
# Old way (still supported):
# secrets:
#   - DB_USERNAME: arn:aws:secretsmanager:us-east-1:123456789012:secret:database-credentials-abc123
#   - DB_PASSWORD: arn:aws:secretsmanager:us-east-1:123456789012:secret:database-credentials-abc123
#   - EXTERNAL_API_KEY: arn:aws:secretsmanager:us-east-1:123456789012:secret:api-keys-def456
# 
# New way (less repetitive):
# secrets_envs:
#   - id: arn:aws:secretsmanager:us-east-1:123456789012:secret:database-credentials-abc123
#     values: [DB_USERNAME, DB_PASSWORD]
#   - id: arn:aws:secretsmanager:us-east-1:123456789012:secret:api-keys-def456
#     values: [EXTERNAL_API_KEY]
